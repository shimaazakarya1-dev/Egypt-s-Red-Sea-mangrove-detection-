from sklearn.preprocessing import StandardScaler
import pandas as pd
import numpy as np
import statsmodels.formula.api as smf
# Load data excel sheet
df = pd.read_excel("D:/model.xlsx")
# identify target predictors
predictors = ['rainfall','sst' , 'sss' , 'spi']
# Log-transform target variable(mangrove area)
df['area_log'] = np.log(df['area'])
# Standardize predictors
scaler = StandardScaler()
df[predictors] = scaler.fit_transform(df[predictors])
# Fit Mixed Effects Model
model = smf.mixedlm("area_log ~ C(Year) + rainfall  + sst + sss + spi",
                    data=df,
                    groups=df["Location"],
                    re_formula="1")
result = model.fit(method='powell')
print(result.summary())
